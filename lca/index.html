<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LCA Web App</title>
    <!-- เพิ่ม Bootstrap CSS จาก CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KyZXEJ+9Qe2p1v0j9fQfz5e6hAfP8YbTL6Wwej48u7jxt4cWV6gFmFt64FwHf4FM" crossorigin="anonymous">
    <style>
        body {
            font-family: Arial, sans-serif;
        }
        table {
            border-collapse: collapse;
            width: 100%;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f2f2f2;
        }
        input {
            width: 100%;
            box-sizing: border-box;
        }
    </style>
</head>
<body class="container mt-4">

<h2>LCA Project</h2>

<!-- ใช้ Bootstrap สำหรับ Select -->
<div class="mb-3">
    <label for="material-select" class="form-label">Select a Material</label>
    <select id="material-select1" class="form-select">
        <option value="">Select a material</option>
    </select>
</div>

<!-- ใช้ Bootstrap สำหรับตาราง -->
<table id="excelTable" class="table table-bordered">
    <thead>
        <tr>
            <th>A</th>
            <th>B</th>
            <th>C</th>
            <th>D</th>
            <th>E</th>
            <th>F</th>
            <th>G</th>
            <th>H</th>
            <th>I</th>
            <th>J</th>
            <th>K</th>
            <th>L</th>
            <th>M</th>
            <th>N</th>
            <th>O</th>
            <th>P</th>
            <th>Q</th>
            <th>R</th>
            <th>S</th>
            <th>T</th>
            <th>U</th>
            <th>V</th>
            <th>W</th>
            <th>X</th>
            <th>Y</th>
            <th>Z</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
            <td><input type="text" oninput="updateCell(this)"></td>
        </tr>
    </tbody>
</table>

<!-- เพิ่มปุ่มเพื่อเพิ่มแถวและคอลัมน์ -->
<div class="mt-3">
    <button class="btn btn-primary" onclick="addRow()">เพิ่มรายการ</button>
    <button class="btn btn-secondary" onclick="addColumn()">เพิ่มคอลัมน์ผลลัพธ์</button>
</div>

<script>
    const materials = [
        "All steel",
        "Aluminium",
        "Battery",
        "Brass",
        "Clay",
        "Concrete",
        "Copper",
        "Glass",
        "Glass wool mat",
        "Gypsum fibreboard",
        "Lubricating oil",
        "Paint",
        "Plastic and rubber",
        "Sand",
        "Sanitary ceramics",
        "Silica",
        "Wood, sawnwood",
        "Working fluid"
    ];
    getRawDropdown('material-select1');
 

    function getRawDropdown(id){
        const select = document.getElementById(id);

        // วนลูปเพื่อเพิ่ม <option> ใน <select>
        materials.forEach(material => {
            const option = document.createElement('option');
            option.value = material;
            option.textContent = material;
            select.appendChild(option);
        });
    
    }

    var col_count = 26;
    function updateCell(input) {
        const cell = input.parentElement;
        const row = cell.parentElement;
        const rowIndex = row.rowIndex - 1; // Subtract 1 to account for the header row
        const cellIndex = cell.cellIndex;

        console.log(`Updated cell at row ${rowIndex}, column ${cellIndex}: ${input.value}`);
    }

    // Function to add a new row
    function addRow() {
        const table = document.getElementById('excelTable').getElementsByTagName('tbody')[0];
        const newRow = table.insertRow();

        for (let i = 0; i < 26; i++) {
            const newCell = newRow.insertCell(i);
            newCell.innerHTML = '<input type="text" oninput="updateCell(this)">';
        }
    }

    // Function to add a new column
    function addColumn() {
        const table = document.getElementById('excelTable');
        const rows = table.getElementsByTagName('tr');

        for (let i = 0; i < rows.length; i++) {
            const newCell = rows[i].insertCell(-1);
            if (i === 0) {
                newCell.innerHTML = String.fromCharCode(65 + rows[i].cells.length - 1);
                newCell.style.backgroundColor = '#f2f2f2';
            } else {
                newCell.innerHTML = '<input type="text" oninput="updateCell(this)">';
            }
        }
    }
</script>

<!-- เพิ่ม Bootstrap JS และ Popper.js (จำเป็นสำหรับบางฟีเจอร์ของ Bootstrap) -->
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz4fnFO9gybF93tu2kX7P5c5Jphf6eAB9RF4i0l3mRxxB1a0gKSPc5gpnT" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.min.js" integrity="sha384-cn7l7gDp0eyniUwwAZgrzZD2JNk5gFCk1yN4n9TzYk6n/xpVYvm82KzG7V5s6Bcw" crossorigin="anonymous"></script>

</body>
</html>
